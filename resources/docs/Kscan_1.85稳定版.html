<h2>Kscan 帮助文档</h2><h3>用法</h3><div><code class="usage">kscan_windows_amd64.exe [-h, --help, --fofa-syntax] <span>(</span>-t, --target, -f, --fofa, --spy<span>)</span> [options] [hydra options] [fofa options]</code></div><details open><summary> <b>可选选项</b></summary><ul><li><code>-h, --help</code>：显示帮助信息并退出。</li><li><code>-f, --fofa</code>：从 FOFA 获取检测对象，需提前配置环境变量 <code>FOFA_EMAIL</code> 和 <code>FOFA_KEY</code>。</li><li><details open><summary> <code>-t, --target</code>：指定探测对象，支持以下格式：</summary><ul><li>IP 地址：<code>114.114.114.114</code></li><li>IP 地址段：<code>114.114.114.114/24</code>（不建议子网掩码小于 12）</li><li>IP 地址范围：<code>114.114.114.114-115.115.115.115</code></li><li>URL 地址：<code>https://www.baidu.com</code></li><li>文件地址：<code>file:/tmp/target.txt</code></li><li>剪切板：<code>paste</code> 或 <code>clipboard</code></li></ul></details></li><li><details open><summary> <code>--spy</code>：网段探测模式，自动探测主机可达的内网网段，可用参数包括：</summary><ul><li>（空）</li><li><code>192</code>、<code>10</code>、<code>172</code></li><li><code>all</code></li><li>指定 IP 地址（将探测该 IP 地址 B 段存活网关）</li></ul></details></li></ul></details><details open><summary> <b>选项</b></summary><ul><li><code>--check</code>：对目标地址进行指纹识别，不会进行端口探测。</li><li><code>--scan</code>：对通过 <code>--fofa</code> 或 <code>--spy</code> 提供的目标对象进行端口扫描和指纹识别。</li><li><code>-p, --port</code>：扫描指定端口，默认扫描 top400 常见端口。支持格式：<code class="full">80,8080,8088-8090</code>。</li><li><code>-o, --output</code>：将扫描结果保存到文件。</li><li><code>-oJ</code>：以 json 格式将扫描结果保存到文件。</li><li><code>-oC</code>：以 csv 格式将扫描结果保存到文件。</li><li><code>-Pn</code>：使用此选项后，将不会进行智能存活性探测。默认会开启智能存活性探测，提高效率。</li><li><code>-Cn</code>：使用此选项后，控制台输出结果将不会带颜色。</li><li><code>-Dn</code>：使用此选项后，将关闭 cdn 识别功能。</li><li><code>-sV</code>：使用此选项后，将对所有端口进行全探针探测。此选项会极大影响效率，需谨慎使用！</li><li><code>--top</code>：扫描经过筛选处理的常见端口 topx，最高支持 1000 个（默认值：<code>400</code>）。</li><li><code>--proxy</code>：设置代理，格式为(<code>socks5://</code>、<code>socks4://</code>、<code>https://</code>、<code>http://</code>)ip:port。</li><li><code>--threads</code>：线程选项，最大值为 2048（默认值：<code>100</code>）。</li><li><code>--path</code>：指定请求访问的目录，只支持单个目录。</li><li><code>--host</code>：指定所有请求的头部 Host 值。</li><li><code>--timeout</code>：设置超时时间。</li><li><code>--encoding</code>：设置终端输出编码，可指定为 <code>gb2312</code> 或 <code>utf-8</code>。</li><li><code>--match</code>：对资产返回的 banner 进行检索，剔除不存在关键字的结果记录。</li><li><code>--not-match</code>：对资产返回的 banner 进行检索，剔除存在关键字的结果记录。</li><li><code>--hydra</code>：自动化爆破支持协议，包括 <code>ssh</code>, <code>rdp</code>, <code>ftp</code>, <code>smb</code>, <code>mysql</code>, <code>mssql</code>, <code>oracle</code>, <code>postgresql</code>, <code>mongodb</code>, <code>redis</code>。默认会开启全部。</li></ul></details><details open><summary> <b>Hydra 选项</b></summary><ul><li><code>--hydra-user</code>：自定义 Hydra 爆破用户名，格式为 <code>username</code> 或 <code class="full">user1,user2</code> 或 <code>file:username.txt</code>。</li><li><code>--hydra-pass</code>：自定义 Hydra 爆破密码，格式为 <code>password</code> 或 <code class="full">pass1,pass2</code> 或 <code>file:password.txt</code>。如果密码中包含逗号，请使用 <code>\,</code> 进行转义，其他符号无需转义。</li><li><code>--hydra-update</code>：自定义用户名和密码模式。如果携带此选项，则为新增模式，会将用户名和密码补充在默认字典后面；否则将替换默认字典。</li><li><code>--hydra-mod</code>：指定自动化暴力破解模块，例如 <code>rdp</code> 或 <code class="full">rdp,ssh,smb</code>。</li></ul></details><details open><summary> <b>FOFA 选项</b></summary><ul><li><code>--fofa-syntax</code>：获取 FOFA 搜索语法说明。</li><li><code>--fofa-size</code>：设置 FOFA 返回的条目数（默认值：<code>100</code>）。</li><li><code>--fofa-fix-keyword</code>：修饰 keyword，该选项中的 <code>{}</code> 最终会替换成 <code>-f</code> 选项的值。</li></ul></details>