<style>table{border-collapse:collapse;}table th,table td{border:1px solid gray;text-align:center;}</style><details open><summary> <b>🔒支持系统列表</b></summary><table data-catalyst=""><table><thead><tr><th>🔒权限维持模块</th><th>CentOS</th><th>Ubuntu</th><th>推荐指数</th><th>需要权限</th><th>备注</th><th>py2</th><th>py3</th></tr></thead><tbody><tr><td>OpenSSH 后门万能密码 &amp; 记录密码</td><td>❌</td><td>✔️</td><td>⭐</td><td>root</td><td>此后门需要很老的内核版本，而且需要很多依赖环境</td><td>❌</td><td>✔️</td></tr><tr><td>PAM 后门</td><td>❌</td><td>❌</td><td>⭐</td><td>❌</td><td>此后门需要很老的内核版本，而且需要很多依赖环境</td><td>❌</td><td>❌</td></tr><tr><td>ssh 软链接</td><td>✔️</td><td>✔️</td><td>⭐ ⭐</td><td>root</td><td>容易被发现</td><td>✔️</td><td>✔️</td></tr><tr><td>ssh 公私密钥</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐ ⭐</td><td>user</td><td>发现程度很难，参考了挖矿病毒</td><td>✔️</td><td>✔️</td></tr><tr><td>后门帐号</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐</td><td>root</td><td>用命令添加账户，不会创建用户 home 目录[有一个是直接指向 root 目录]</td><td>✔️</td><td>✔️</td></tr><tr><td>crontab 计划任务</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐</td><td>user or root</td><td>难以发现，通过执行计划任务</td><td>✔️</td><td>✔️</td></tr><tr><td>strace 后门</td><td>✔️</td><td>✔️</td><td>⭐ ⭐</td><td>root</td><td>键盘记录的后门</td><td>✔️</td><td>✔️</td></tr><tr><td>alias 后门</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐</td><td>root</td><td>别名后门，难以发现，但是需要用户去执行命令</td><td>✔️</td><td>✔️</td></tr><tr><td>rootkit 后门[检测]</td><td>❌</td><td>❌</td><td>⭐ ⭐ ⭐</td><td>root</td><td>难以发现，但是安装复杂，而且指定内核版本</td><td>❌</td><td>❌</td></tr><tr><td>临时 history 不记录命令 or 永久不记录命令</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐⭐⭐⭐</td><td>root</td><td>有的服务器设置了空格记录执行命令，执行这个脚本快速设置不记录空格命令</td><td>✔️</td><td>✔️</td></tr><tr><td>ssh 软链接 &amp; crontab</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐</td><td>root</td><td>快速生成软链接，并且执行计划任务，每分钟判断当前软链接是否存在，如果被 kill 掉，就重新执行</td><td>✔️</td><td>✔️</td></tr><tr><td>check.py</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐⭐⭐</td><td>user</td><td>快速检测目标机器可以使用那个权限维持模块，并且检测当前机器处于 docker 还是 k8s，并检测 docker 逃逸</td><td>✔️</td><td>✔️</td></tr><tr><td>sshkey 密钥 &amp; crontab</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐⭐ ⭐</td><td>user or root</td><td>快速生成 ssh 密钥，并且执行计划任务，每分钟判断当前密钥和多个文件是否存在，如果被 kill 掉，就重新执行</td><td>✔️</td><td>✔️</td></tr><tr><td>php 权限维持不死免杀马</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐⭐ ⭐</td><td>user or root</td><td>phpweb 权限维持马</td><td>✔️</td><td>✔️</td></tr><tr><td>suid shell bash</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐ ⭐</td><td>root</td><td>suid shell bash 脚本(低权限用户运行)，可以和 webshell 进行联动一个低权限用户只需要执行一个文件就可以获取高权限</td><td>✔️</td><td>✔️</td></tr><tr><td>BT 面板后渗透[bt_T00ls_v7.0]内部版</td><td>✔️</td><td>✔️</td><td>⭐ ⭐ ⭐ ⭐ ⭐</td><td>root</td><td>BT 面板后渗透【bt_T00ls_v7.0】内部版</td><td>✔️</td><td>✔️</td></tr></tbody></table></table></details><details open><summary> <b>🔐权限的划分</b></summary><table data-catalyst=""><table><thead><tr><th>UID</th><th>数值</th><th>示例</th></tr></thead><tbody><tr><td>0</td><td>超级管理员（root 用户）</td><td>root</td></tr><tr><td>1～999</td><td>Linux 系统将一些服务程序和系统任务分配给独立的系统用户来运行</td><td>bin</td></tr><tr><td>1000</td><td>普通用户 UID 从 1000 开始</td><td>www-data,www</td></tr></tbody></table></table></details><h3>用法</h3><code class="usage">python main.py [-h] [-m MULTIPLE] [-c CONFIG]</code><details open><summary> <b>选项</b></summary><ul><li><code>-m MULTIPLE, --multiple MULTIPLE</code>：选择权限维持模块 -m 1</li><li><code>-c CONFIG, --config CONFIG</code>：查看支持的权限维持模块 -c 1,查看详细使用说明 -c 2</li></ul></details>