<h2>EZ扫描检测工具 帮助文档</h2><h3>免责声明</h3><ol><li style="color: red;">本软件仅用于经授权的渗透测试使用，请在使用本工具进行渗透测试前，必须获得直接测试目标单位的书面授权。非经被测试目标单位授权，禁止使用本工具实施任何未经许可的测试行为。</li><li style="color: red;">用户通过使用本软件所获取的任何资产或漏洞等信息，必须严格按照测试目标单位的要求予以处理，未经许可不得对信息另行加工、对外传输提供及非法公开。</li><li>本软件通过提交申请信息，提供证书授权给用户使用，默认授权使用时间为1个月，禁止任何形式的复制、分发和传播该证书。用户应对授权期间的使用行为负责，如未取得被测试目标单位的授权或随意复制、分发及传播该证书致使本软件被他人恶意使用而导致的违法责任，用户应依法承担相应责任。</li><li>禁止对本软件实施逆向工程、反编译、篡改软件认证流程和试图破译源代码等行为，通过前述行为恶意绕开软件使用的管控限制。</li><li>如发现用户您有上述禁止行为，或者在使用本软件过程中存在任何非法行为，我们将保留追究用户您法律责任的权利，并将配合执法单位提供证据材料，追究违法责任。</li><li><div>我们已对软件使用合规要件做了充分提示，具体详见前第1-4项内容，如用户违法前述要求导致的任何责任，与我们无关，将由用户自行承担全部责任。</div><br><div style="color: red;">用户您已知悉并同意，为保证软件使用行为即渗透测试行为的可追溯，本软件在使用期间将有限收集个人PC信息，包括MAC地址、本机IP地址以及启动时间等，必要时将提供政府监管部门。</div></li></ol><h3>用法</h3><code class="usage">ez.exe [全局选项] 命令 [命令选项] [选项...]</code><details open><summary> <b>全局选项</b></summary><ul><li><code>-l value, --log-level value</code>：日志级别，可选值包括 <code>debug</code>、<code>info</code>、<code>warn</code>、<code>warning</code>、<code>success</code>（默认值：<code>info</code>）</li><li><code>-c value, --config value</code>：从文件加载 ez 配置（默认值：<code>config.yaml</code>）</li><li><code>--lic value</code>：ez 许可证文件（默认值：<code>ez.lic</code>）</li><li><code>--check-reverse</code>：检查反向服务是否在线，完成后退出程序（默认值：<code>false</code>）</li><li><code>-h, --help</code>：显示帮助信息</li></ul></details><details open><summary> <b>命令</b></summary><ul><li><details open><summary> <code class="usage">ez.exe webscan</code>：运行一个网站扫描任务</summary><ul><li><code>--pocs value</code>：选择运行的 PoC，多个 PoC 用逗号分隔（默认全部）。</li><li><code>--disable-pocs value</code>：选择排除的 PoC，多个 PoC 用逗号分隔（默认无）。</li><li><code>--hosts value</code>：目标域名白名单，多个域名用逗号分隔，覆盖 config.yaml 中的白名单（默认全部）。</li><li><code>--disable-hosts value</code>：目标域名黑名单，多个域名用逗号分隔，覆盖 config.yaml 中的黑名单（默认无）。</li><li><code>--level value</code>：设置扫描覆盖的最低漏洞等级（默认值：<code>0</code>；可选：0：低、1：中、2：高、3：严重）。</li><li><code>--listen value</code>：设置资源收集代理（默认值：<code>127.0.0.1:2222</code>）。</li><li><code>--listen-auth value</code>：设置代理的账号密码（格式 user:pass）。</li><li><code>--proxy value</code>：通过 HTTP/SOCKS5 代理发送请求（默认无；配置示例：<code>http://127.0.0.1:8080</code> 或 <code>socks5://127.0.0.1:1080</code>）。</li><li><code>-u value, --url value</code>：指定单个 URL 进行扫描。</li><li><code>--uf value, --urls-file value</code>：从本地文件读取目标 URL 列表进行扫描，每行一个 URL。</li><li><code>-r value, --raw value</code>：加载本地 HTTP 请求文件进行重放。</li><li><code>--rhs, --raw-https</code>：对原始请求文件强制使用 SSL（默认值：<code>false</code>）。</li><li><code>--urls-fofa value</code>：从 FOFA 搜索引擎获取目标 URL。</li><li><code>--crawler</code>：基础爬虫，对由 -u 或 --uf 参数指定的目标 URL 进行爬取，默认超时30分钟（默认值：<code>false</code>）。</li><li><code>--crawler-headless</code>：无头浏览器爬虫：使用 Chrome Headless 对由 -u 或 --uf 参数指定的目标 URL 进行爬取，需在 config.yaml 配置 max_crawler_count 参数（默认值：<code>false</code>）。</li><li><code>--dsm, --disable-strict-mode</code>：禁用严格模式（默认值：<code>false</code>）。</li><li><code>--wait-login</code>：无头爬虫在登录页面等待手动输入凭证（默认值：<code>false</code>）。</li><li><code>--list-pocs</code>：列举所有 PoCs（默认值：<code>false</code>）。</li><li><code>--max-crawler value</code>：爬虫抓取的 URL 数量上限（默认值：<code>200</code>）。</li><li><code>--ho value, --html-output value</code>：输出扫描结果到指定 html 文件（默认值：<code>result.html</code>）。</li><li><code>--jo value, --json-output value</code>：输出扫描结果到指定 json 文件。</li><li><code>--wo value, --webhook-output value</code>：将结果以 json 格式发送至指定 URL。</li><li><code>--exploit</code>：尝试执行 Webshell 攻击 Payload（默认值：<code>false</code>）。</li><li><code>--nff, --no-force-finger</code>：未识别指纹时跳过相关 PoC 检测（默认值：<code>false</code>）。</li><li><code>--ac, --alive-check</code>：使用 HEAD 方法预检 URL 可用性（默认值：<code>false</code>）。</li><li><code>--ao value, --alive-output value</code>：输出存活 URL 列表到指定 json 文件（默认值：<code>ez_result_webscan_alive.json</code>）。</li><li><code>--h1 value, --headers1 value</code>：添加 HTTP 头（Windows：<code class="full">--h1={\"Cookie\":\"SESSIONID=XXX\"}</code>；Linux：<code class="full">--h1='{"Cookie":"SESSIONID=XXX"}'</code>）。</li><li><code>--h2 value, --headers2 value</code>：添加备用 HTTP 头（Windows：<code class="full">--h2={\"Cookie\":\"SESSIONID=YYY\"}</code>；Linux：<code class="full">--h2='{"Cookie":"SESSIONID=YYY"}'</code>）。</li><li><code>--apiscan</code>：启用对 API 端点的自动化测试（默认值：<code>false</code>）。</li><li><code>--api-url value</code>：指定目标 API 的 Swagger/OpenAPI 文档地址。</li></ul></details></li><li><details open><summary> <code class="usage">ez.exe servicescan</code>：运行一个服务扫描任务</summary><ul><li><code>--hosts value</code>：指定目标主机，多个目标用逗号分隔（支持 <code>192.168.0.1</code>、<code>192.168.0-255.1</code>、<code>192.168.2.1/24</code> 等多种格式）。</li><li><code>--hf value, --hosts-file value</code>：从本地文件读取目标主机列表，每行一个主机。</li><li><code>--ports value</code>：指定端口范围或预设值，支持格式如1-65535或top2000（默认值：<code>80,443</code>；支持 <code>80,443</code>、<code>1-65535</code>、<code>top2000</code> 等多种格式）。</li><li><code>--hpf value, --hostports-file value</code>：从本地文件读取目标 host:port 组合，每行一个组合。</li><li><code>--pocs value</code>：选择运行的 PoC，多个目标用逗号分隔（默认全部）。</li><li><code>--disable-pocs value</code>：选择排除的 PoC，多个目标用逗号分隔（默认无）。</li><li><code>--fofa value</code>：通过 FOFA 语法指定目标。</li><li><code>--sp, --shell-ping</code>：使用系统 ping 命令替代 ICMP 检测，适用于非 root 权限环境（默认值：<code>false</code>）。</li><li><code>--np, --no-ping</code>：跳过主机存活检测（默认值：<code>false</code>）。</li><li><code>--ns, --no-syn</code>：禁用 SYN 扫描，改用 TCP 连接扫描（默认值：<code>false</code>）。</li><li><code>--jo value, --json-output value</code>：输出扫描结果到指定 json 文件（默认值：<code>ez_result_servicescan.json</code>）。</li><li><code>--so value, --service-output value</code>：输出服务识别结果到指定 json 文件（默认值：<code>ez_result_service.json</code>）。</li><li><code>--ao value, --alive-output value</code>：输出存活主机列表到指定 json 文件。</li><li><code>--ho value, --html-output value</code>：输出扫描结果到指定 html 文件（默认值：<code>result.html</code>）。</li></ul></details></li><li><details open><summary> <code class="usage">ez.exe dnsscan</code>：运行一个 DNS 扫描任务，收集子域名</summary><ul><li><code>-d value, --domain value</code>：指定目标域名，多个目标用逗号分隔。</li><li><code>--dda, --disable-domain-api</code>：禁用通过域名 API 接口收集子域名（默认值：<code>false</code>）。</li><li><code>--df value, --domain-file value</code>：从本地文件读取目标域名列表，每行一个域名。</li><li><code>--sdf value, --subdomain-file value</code>：从本地文件读取目标子域名列表，每行一个子域名。</li><li><code>--bd value, --brute-dict value</code>：指定暴力破解字典路径（默认使用内置字典，约 9 万条域名）。</li><li><code>--slow</code>：精确模式，同时通过所有 DNS 解析子域名（默认值：<code>false</code>，只随机使用一个 DNS 解析子域名）。</li><li><code>-o value, --output value</code>：输出子域名扫描结果到指定 txt 文件（默认值：<code>subdomain.txt</code>）。</li><li><code>--oj value, --output-json value</code>：输出子域名扫描结果到指定 json 文件。</li></ul></details></li><li><details open><summary> <code class="usage">ez.exe brute</code>：运行一个暴力破解服务扫描任务</summary><ul><li><details open><summary> 暴力破解支持的服务名：[<code>ssh</code>、<code>ssh-key</code>、<code>wmi</code>、<code>smb</code>、<code>mysql</code>、<code>vnc</code>、<code>redis</code>、<code>mssql</code>、<code>vmauth</code>、<code>esxi</code>、<code>ftp</code>、<code>ldap</code>、<code>postgresql</code>、<code>oracle</code>、<code>mongodb</code>、<code>snmp</code>、<code>rdp</code>]</summary><ul><li><details open><summary> Brute ssh</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:22:ssh -u root,admin -p 123456,Passw0rd,P@ssword</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:22:ssh -u root,admin -p 123456,Passw0rd,P@ssword --command "touch /tmp/success"</code></li></ul></details></li><li><details open><summary> Brute ssh-key</summary><ul><li><code class="usage">ez --log-level debug brute --hosts 1.1.1.1:22:ssh-key -u root,admin --ssh-key ./id_rsa</code></li><li><code class="usage">ez --log-level debug brute --hosts 1.1.1.1:22:ssh-key -u root,admin --ssh-key ./id_rsa --command "touch /tmp/success"</code></li></ul></details></li><li><details open><summary> Brute vnc（VNC 服务最多允许 5 次密码爆破，超过限制将封禁 IP）</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:5901:vnc -p 123456,Passw0rd,P@ssword</code></li></ul></details></li><li><details open><summary> Brute redis</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:6379:redis -p foobared,123456,Passw0rd,P@ssword</code></li></ul></details></li><li><details open><summary> Brute smb（暴力破解不支持使用 SMBv1 的系统，如 Windows 2003、Windows XP）</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:445:smb -u administrator -p 123456,Passw0rd,P@ssword</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:445:smb -u dmz.com\lijie -p 123456,Passw0rd,P@ssword</code>（支持带域名的用户名）</li><li><code class="usage">ez brute --hosts 1.1.1.1:445:smb -u dmz.com\lijie -p 123456,Passw0rd,2b91c45b0efe26d8f5cf51818b19a8bf</code>（若密码长度为 32 位，将作为密码和 NTLM 分别尝试）</li></ul></details></li><li><details open><summary> Brute rdp（暴力破解不支持 Windows 2003、Windows XP）</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:3389:rdp -u administrator -p 123456,Passw0rd,P@ssword</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:3389:rdp -u dmz.com\lijie -p 123456,Passw0rd,P@ssword</code>（支持带域名的用户名）</li></ul></details></li><li><details open><summary> Brute wmi</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:135:wmi -u administrator -p 123456,Passw0rd,P@ssword</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:135:wmi -u dmz.com\lijie -p 123456,Passw0rd,P@ssword</code>（支持带域名的用户名）</li><li><code class="usage">ez brute --hosts 1.1.1.1:135:wmi -u dmz.com\lijie -p 123456,Passw0rd,2b91c45b0efe26d8f5cf51818b19a8bf</code>（若密码长度为 32 位，将作为密码和 NTLM 分别尝试）</li></ul></details></li><li><details open><summary> Brute vmauth</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:902:vmauth -u root -p password</code></li></ul></details></li><li><details open><summary> Brute ftp</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:21:ftp -d</code></li></ul></details></li><li><details open><summary> Brute esxi</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:443:esxi -u root -p password</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:443:esxi -u root -p password --command list</code>（将列出所有虚拟机的详情）</li></ul></details></li><li><details open><summary> Brute ldap</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:389:ldap -u admin -p 123456</code>（将自动提取用户 DN）</li><li><code class="usage">ez brute --hosts 1.1.1.1:389:ldap -u cn=admin,dc=test,dc=com,dc=cn -p password</code></li></ul></details></li><li><details open><summary> Brute mssql</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:1433:mssql --up sa:Hello_Ez_123 -u test -p test,test123</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:1433:mssql -u sa -p Hello_Ez_123 --command "SELECT Name FROM Master..SysDatabases ORDER BY Name" --skip</code></li></ul></details></li><li><details open><summary> Brute oracle</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:1521:oracle --up orcl\system:system -u orcl\test -p test,test123</code></li><li><code class="usage">ez brute --hosts 1.1.1.1:1521:oracle -u system -p Hello_Ez_123,system --skip</code>（默认使用 orcl 作为服务名）</li></ul></details></li><li><details open><summary> Brute mongodb</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:27017:mongodb -d</code></li></ul></details></li><li><details open><summary> Brute mysql</summary><ul><li><code class="usage">ez brute --hosts 1.1.1.1:3306:mysql --up root:Hello_Ez_123</code></li><li><code class="usage">ez brute --hosts-file mysql_hosts.txt -u root --passwords-file passwords.txt -p Hello_Ez_123 --up root:admin@123</code></li></ul></details></li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>--hosts value</code>：指定目标 host:port:服务名 组合列表，多个组合用逗号分隔。</li><li><code>--hf value, --hosts-file value</code>：从本地文件读取目标 host:port:服务名 组合列表，每行一个组合。</li><li><code>-d, --default-user-pass</code>：按目标服务类型加载内置用户/密码表，如需自定义，请修改目录 data/data 下的对应文件（默认值：<code>false</code>）。</li><li><code>-u value, --users value</code>：指定用户名列表，同时应用于所有服务，多个用户名用逗号分隔。</li><li><code>--uf value, --users-file value</code>：从本地文件读取用户名列表，同时应用于所有服务，每行一个用户名。</li><li><code>-p value, --passwords value</code>：指定密码列表，同时应用于所有服务，多个密码用逗号分隔。</li><li><code>--pf value, --passwords-file value</code>：从本地文件读取密码列表，同时应用于所有服务，每行一个密码。</li><li><code>--up value, --user-passwords value</code>：指定 用户名:密码 组合列表，同时应用于所有服务，多个组合用逗号分隔。</li><li><code>--upf value, --user-passwords-file value</code>：从本地文件读取 用户名:密码 组合列表，同时应用于所有服务，每行一个组合。</li><li><code>--skip</code>：跳过服务验证，直接爆破目标主机（默认值：<code>false</code>）。</li><li><code>--ssh-key value</code>：指定私钥文件，仅用于 ssh-key 的爆破。</li><li><code>--command value</code>：爆破成功后执行指定命令，仅用于 ssh、ssh-key、mssql、esxi 的爆破。</li><li><code>-o value, --output value</code>：输出爆破结果到指定 json 文件（默认值：<code>ez_result_brute.json</code>）。</li></ul></details></li></ul></details></li><li><code class="usage">ez.exe reverse</code>：运行一个独立的反向服务器</li><li><details open><summary> <code class="usage">ez.exe web</code>：运行一个 Web 服务器</summary><ul><li><code>--web-listen value</code>：设置 Web 服务器监听的 IP 和端口（默认值：<code>0.0.0.0:8888</code>）。</li><li><code>--rwp, --reset-web-password</code>：强制重置 Web 管理界面密码（默认值：<code>false</code>）。</li><li><code>--sp value, --safe-path value</code>：访问 Web 服务器前要先请求的安全路径（默认随机生成）。</li><li><code>--nsp, --no-safe-path</code>：直接访问 Web 服务器，不使用安全路径（默认值：<code>false</code>）。</li><li><code>--pocs value</code>：选择运行的 PoC，多个 PoC 用逗号分隔（默认全部）。</li><li><code>--disable-pocs value</code>：选择排除的 PoC，多个 PoC 用逗号分隔（默认无）。</li><li><code>--hosts value</code>：目标域名白名单，多个域名用逗号分隔，覆盖 config.yaml 中的白名单（默认全部）。</li><li><code>--disable-hosts value</code>：目标域名黑名单，多个域名用逗号分隔，覆盖 config.yaml 中的黑名单（默认无）。</li><li><code>--level value</code>：设置扫描覆盖的最低漏洞等级（默认值：<code>0</code>；可选：0：低、1：中、2：高、3：严重）。</li><li><code>--listen value</code>：设置资源收集代理（默认值：<code>127.0.0.1:2222</code>）。</li><li><code>--listen-auth value</code>：设置代理的账号密码（格式 user:pass）。</li><li><code>--proxy value</code>：通过 HTTP/SOCKS5 代理发送请求（默认无；配置示例：<code>http://127.0.0.1:8080</code> 或 <code>socks5://127.0.0.1:1080</code>）。</li><li><code>--ho value, --html-output value</code>：输出扫描结果到指定 html 文件（默认值：<code>result.html</code>）。</li><li><code>--crawler-headless</code>：无头浏览器爬虫：使用 Chrome Headless 对由 -u 或 --uf 参数指定的目标 URL 进行爬取，需在 config.yaml 配置 max_crawler_count 参数（默认值：<code>false</code>）。</li><li><code>--jo value, --json-output value</code>：输出扫描结果到指定 json 文件。</li><li><code>--wo value, --webhook-output value</code>：将结果以 json 格式发送至指定 URL。</li><li><code>--exploit</code>：尝试执行 Webshell 攻击 Payload（默认值：<code>false</code>）。</li><li><code>--nff, --no-force-finger</code>：未识别指纹时跳过相关 PoC 检测（默认值：<code>false</code>）。</li></ul></details></li><li><details open><summary> <code class="usage">ez.exe crawler</code>：运行一个爬虫任务</summary><ul><li><code>-u value, --url value</code>：指定单个 URL 进行爬取。</li><li><code>--uf value, --urls-file value</code>：从本地文件读取目标 URL 列表进行爬取，每行一个 URL。</li><li><code>--chrome-path value</code>：自定义 Chrome 浏览器可执行文件路径。</li><li><code>--max-crawler-count value</code>：限制最大爬取请求数（默认值：<code>0</code>，表示无限制）。</li><li><code>-t value, --thread value</code>：设置并发线程数（默认值：<code>0</code>，表示自动优化）。</li><li><code>--disable-headless</code>：禁用无头模式（默认值：<code>false</code>）。</li><li><code>--proxy value</code>：通过 HTTP/SOCKS5 代理发送请求（默认无；配置示例：<code>http://127.0.0.1:8080</code> 或 <code>socks5://127.0.0.1:1080</code>）。</li><li><code>--text-output value</code>：输出爬取结果到指定 txt 文件。</li><li><code>--json-output value</code>：输出爬取结果到指定 json 文件。</li><li><code>--wait-login</code>：无头爬虫在登录页面等待手动输入凭证（默认值：<code>false</code>）。</li></ul></details></li><li><code class="usage">ez.exe mid [ez.exe machineid]</code>：生成机器 ID</li><li><code class="usage">ez.exe exploit</code>：利用工具</li></ul></details>