<h2>SQLMAP 帮助文档</h2><h3>用法</h3><div><code class="usage">python sqlmap.py [选项]</code></div><h3>选项列表</h3><details open><summary> <b>基本选项</b></summary><ul><li><code>-h, --help</code>：显示基本帮助信息并退出。</li><li><code>-hh</code>：显示高级帮助信息并退出。</li><li><code>--version</code>：显示程序版本号并退出。</li><li><code>-v VERBOSE</code>：设置详细级别（默认值：<code>1</code>；范围从 0 到 6）。</li></ul></details><details open><summary> <b>目标选项</b></summary><ul><li><code>-u URL, --url=URL</code>：指定目标 URL（例如：<code class="full">"http://www.site.com/vuln.php?id=1"</code>）。</li><li><code>-d DIRECT</code>：指定连接字符串格式的目标数据库 URL。</li><li><code>-l LOGFILE</code>：从 Burp 或 WebScarab 代理日志解析目标。</li><li><code>-m BULKFILE</code>：扫描文本文件中指定的多个目标。</li><li><code>-r REQUESTFILE</code>：从文件加载 HTTP 请求。</li><li><code>-g GOOGLEDORK</code>：将 Google 搜索结果作为目标 URL 处理。</li><li><code>-c CONFIGFILE</code>：从 INI 配置文件加载选项。</li></ul></details><details open><summary> <b>请求选项</b></summary><ul><li><code>-A AGENT, --user-agent=AGENT</code>：HTTP 用户代理头值。</li><li><code>-H HEADER, --header=HEADER</code>：额外请求头（例如：<code class="full">"X-Forwarded-For: 127.0.0.1"</code>）。</li><li><code>--method=METHOD</code>：强制使用指定 HTTP 方法（例如：<code>PUT</code>）。</li><li><code>--data=DATA</code>：通过POST发送的数据（例如：<code class="full">"id=1"</code>）。</li><li><code>--param-del=PARAM_DELIMITER</code>：参数值分隔符（例如：<code>&</code>）。</li><li><code>--cookie=COOKIE</code>：HTTP Cookie 头值（例如：<code class="full">"PHPSESSID=a8d127e.."</code>）。</li><li><code>--cookie-del=COOKIE_DELIMITER</code>：Cookie 值分隔符（例如：<code>;</code>）。</li><li><code>--live-cookies=LIVE_COOKIES</code>：用于加载最新值的实时 Cookie 文件。</li><li><code>--load-cookies=LOAD_COOKIES</code>：包含 Netscape/wget 格式 Cookie 的文件。</li><li><code>--drop-set-cookie</code>：忽略响应中的 Set-Cookie 头。</li><li><code>--mobile</code>：通过用户代理模拟智能手机。</li><li><code>--random-agent</code>：使用随机生成的用户代理。</li><li><code>--host=HOST</code>：指定 HTTP Host 头值。</li><li><code>--referer=REFERER</code>：指定 HTTP Referer 头值。</li><li><code>--headers=HEADERS</code>：额外请求头（多行格式，例如：<code class="full">"Accept-Language: fr\nETag: 123"</code>）。</li><li><code>--auth-type=AUTH_TYPE</code>：HTTP 认证类型（<code>Basic</code>、<code>Digest</code>、<code>Bearer</code> 等）。</li><li><code>--auth-cred=AUTH_CRED</code>：HTTP 认证凭据（格式：<code>用户名:密码</code>）。</li><li><code>--auth-file=AUTH_FILE</code>：HTTP 认证 PEM 证书/私钥文件。</li><li><code>--abort-code=ABORT_CODE</code>：遇到指定 HTTP 错误码时中止（例如：<code>401</code>）。</li><li><code>--ignore-code=IGNORE_CODE</code>：忽略指定HTTP错误码（例如：<code>401</code>）。</li><li><code>--ignore-proxy</code>：忽略系统默认代理设置。</li><li><code>--ignore-redirects</code>：忽略重定向尝试。</li><li><code>--ignore-timeouts</code>：忽略连接超时。</li><li><code>--proxy=PROXY</code>：使用代理连接目标。</li><li><code>--proxy-cred=PROXY_CRED</code>：代理认证凭据（格式：<code>用户名:密码</code>）。</li><li><code>--proxy-file=PROXY_FILE</code>：从文件加载代理列表。</li><li><code>--proxy-freq=PROXY_FREQ</code>：指定代理切换频率。</li><li><code>--tor</code>：使用 Tor 匿名网络。</li><li><code>--tor-port=TORPORT</code>：设置非默认 Tor 代理端口。</li><li><code>--tor-type=TORTYPE</code>：设置 Tor 代理类型（默认值：<code>SOCKS5</code>；可选：<code>HTTP</code>、<code>SOCKS4</code>、<code>SOCKS5</code>）。</li><li><code>--check-tor</code>：检查 Tor 是否正确使用。</li><li><code>--delay=DELAY</code>：请求间延迟秒数。</li><li><code>--timeout=TIMEOUT</code>：连接超时时间（默认值：<code>30</code>；单位：秒）。</li><li><code>--retries=RETRIES</code>：连接超时重试次数（默认值：<code>3</code>）。</li><li><code>--retry-on=RETRYON</code>：根据正则表达式重试请求（例如：<code>"drop"</code>）。</li><li><code>--randomize=RPARAM</code>：随机化指定参数值。</li><li><code>--safe-url=SAFEURL</code>：测试期间定期访问的安全 URL。</li><li><code>--safe-post=SAFE_POST_DATA</code>：发送到安全 URL 的 POST 数据。</li><li><code>--safe-req=SAFEREQ_FILE</code>：从文件加载安全 HTTP 请求。</li><li><code>--safe-freq=SAFE_FREQ</code>：访问安全 URL 的请求间隔。</li><li><code>--skip-urlencode</code>：跳过载荷数据的 URL 编码。</li><li><code>--csrf-token=CSRF_TOKEN</code>：反 CSRF 令牌参数名。</li><li><code>--csrf-url=CSRFURL</code>：提取反 CSRF 令牌的 URL。</li><li><code>--csrf-method=CSRF_METHOD</code>：获取 CSRF 令牌的 HTTP 方法。</li><li><code>--csrf-data=CSRF_DATA</code>：获取 CSRF 令牌时发送的 POST 数据。</li><li><code>--csrf-retries=CSRF_RETRIES</code>：获取 CSRF 令牌的重试次数（默认值：<code>0</code>）。</li><li><code>--force-ssl</code>：强制使用 SSL/HTTPS。</li><li><code>--chunked</code>：使用 HTTP 分块传输编码。</li><li><code>--hpp</code>：使用 HTTP 参数污染技术。</li><li><code>--eval=EVALCODE</code>：请求前执行 Python 代码（例如：<code class="full">"import hashlib;id2=hashlib.md5(id).hexdigest()"</code>）。</li></ul></details><details open><summary> <b>优化选项</b></summary><ul><li><code>-o</code>：启用所有优化开关。</li><li><code>--predict-output</code>：预测常见查询输出。</li><li><code>--keep-alive</code>：使用持久连接。</li><li><code>--null-connection</code>：获取响应长度而不下载内容。</li><li><code>--threads=THREADS</code>：最大并发请求数（默认值：<code>1</code>）。</li></ul></details><details open><summary> <b>注入选项</b></summary><ul><li><code>-p TESTPARAMETER</code>：指定测试参数。</li><li><code>--skip=SKIP</code>：跳过指定参数的测试。</li><li><code>--skip-static</code>：跳过静态参数的测试。</li><li><code>--param-exclude=REGEX</code>：通过正则排除测试参数（例如：<code>"ses"</code>）。</li><li><code>--param-filter=PLACE</code>：按位置筛选参数（例如：<code>"POST"</code>）。</li><li><code>--dbms=DBMS</code>：强制指定后端数据库类型。</li><li><code>--dbms-cred=DBMS_CRED</code>：数据库认证凭据（格式：<code>用户:密码</code>）。</li><li><code>--os=OS</code>：强制指定数据库操作系统。</li><li><code>--invalid-bignum</code>：使用大数字使值失效。</li><li><code>--invalid-logical</code>：使用逻辑运算使值失效。</li><li><code>--invalid-string</code>：使用随机字符串使值失效。</li><li><code>--no-cast</code>：禁用载荷转换机制。</li><li><code>--no-escape</code>：禁用字符串转义机制。</li><li><code>--prefix=PREFIX</code>：注入载荷前缀。</li><li><code>--suffix=SUFFIX</code>：注入载荷后缀。</li><li><code>--tamper=TAMPER</code>：使用篡改脚本处理注入数据。</li></ul></details><details open><summary> <b>检测选项</b></summary><ul><li><code>--level=LEVEL</code>：检测等级（默认值：<code>1</code>；范围从 1 到 5）。</li><li><code>--risk=RISK</code>：检测风险等级（默认值：<code>1</code>；范围从 1 到 3）。</li><li><code>--string=STRING</code>：真条件时匹配的字符串。</li><li><code>--not-string=NOT_STRING</code>：假条件时匹配的字符串。</li><li><code>--regexp=REGEXP</code>：真条件时匹配的正则表达式。</li><li><code>--code=CODE</code>：真条件时匹配的 HTTP 状态码。</li><li><code>--smart</code>：仅在启发式检测成功后进行全面测试。</li><li><code>--text-only</code>：仅基于文本内容比较页面。</li><li><code>--titles</code>：仅基于标题比较页面。</li></ul></details><details open><summary> <b>技术选项</b></summary><ul><li><code>--technique=TECHNIQUES</code>：使用的注入技术（默认值：<code>BEUSTQ</code>）。</li><li><code>--time-sec=TIMESEC</code>：DBMS 响应延迟时间（默认值：<code>5</code>；单位：秒）。</li><li><code>--union-cols=UCOLS</code>：UNION 注入测试列数范围。</li><li><code>--union-char=UCHAR</code>：UNION 列数爆破使用的填充字符。</li><li><code>--union-from=UFROM</code>：UNION 查询 FROM 子句使用的表。</li><li><code>--union-values=UVALUES</code>：UNION 查询使用的列值。</li><li><code>--dns-domain=DNS_DOMAIN</code>：DNS 渗出攻击使用的域名。</li><li><code>--second-url=SECOND_URL</code>：二阶响应的结果页面 URL。</li><li><code>--second-req=SECOND_REQ</code>：从文件加载二阶 HTTP 请求。</li></ul></details><details open><summary> <b>指纹选项</b></summary><ul><li><code>-f, --fingerprint</code>：执行详细的 DBMS 版本指纹识别。</li></ul></details><details open><summary> <b>枚举选项</b></summary><ul><li><code>-a, --all</code>：获取所有信息。</li><li><code>-b, --banner</code>：获取 DBMS 标识。</li><li><code>--current-user</code>：获取当前用户。</li><li><code>--current-db</code>：获取当前数据库。</li><li><code>--hostname</code>：获取数据库主机名。</li><li><code>--is-dba</code>：检测当前用户是否为 DBA。</li><li><code>--users</code>：枚举数据库用户。</li><li><code>--passwords</code>：枚举用户密码哈希。</li><li><code>--privileges</code>：枚举用户权限。</li><li><code>--roles</code>：枚举用户角色。</li><li><code>--dbs</code>：枚举数据库。</li><li><code>--tables</code>：枚举表。</li><li><code>--columns</code>：枚举列。</li><li><code>--schema</code>：枚举模式。</li><li><code>--count</code>：获取表的条目数。</li><li><code>--dump</code>：转储表数据。</li><li><code>--dump-all</code>：转储所有数据库表数据。</li><li><code>--search</code>：搜索数据库/表/列。</li><li><code>--comments</code>：枚举时检查注释。</li><li><code>--statements</code>：检索执行的 SQL 语句。</li><li><code>-D DB</code>：指定要枚举的数据库。</li><li><code>-T TBL</code>：指定要枚举的表。</li><li><code>-C COL</code>：指定要枚举的列。</li><li><code>-X EXCLUDE</code>：排除的数据库标识符。</li><li><code>-U USER</code>：指定要枚举的用户。</li><li><code>--exclude-sysdbs</code>：排除系统数据库。</li><li><code>--pivot-column=PIVOT_COLUMN</code>：透视列名。</li><li><code>--where=DUMPWHERE</code>：数据转储时的 WHERE 条件。</li><li><code>--start=LIMITSTART</code>：起始转储条目。</li><li><code>--stop=LIMITSTOP</code>：结束转储条目。</li><li><code>--first=FIRSTCHAR</code>：查询结果的首字符位置。</li><li><code>--last=LASTCHAR</code>：查询结果的末字符位置。</li><li><code>--sql-query=SQLQUERY</code>：执行自定义 SQL 语句。</li><li><code>--sql-shell</code>：交互式 SQL shell。</li><li><code>--sql-file=SQLFILE</code>：从文件执行 SQL 语句。</li></ul></details><details open><summary> <b>爆破选项</b></summary><ul><li><code>--common-tables</code>：检查常见表是否存在。</li><li><code>--common-columns</code>：检查常见列是否存在。</li><li><code>--common-files</code>：检查常见文件是否存在。</li></ul></details><details open><summary> <b>用户定义注入选项</b></summary><ul><li><code>--udf-inject</code>：注入自定义 UDF。</li><li><code>--shared-lib=SHLIB</code>：共享库本地路径。</li></ul></details><details open><summary> <b>文件系统访问选项</b></summary><ul><li><code>--file-read=REMOTE_FILE</code>：读取数据库服务器文件。</li><li><code>--file-write=LOCAL_FILE</code>：写入文件到数据库服务器。</li><li><code>--file-dest=REMOTE_DEST</code>：服务器文件写入路径。</li><li><code>--xp-upload=XPC_FILE</code>：通过 xp_cmdshell 上传文件。</li><li><code>--ole-upload=OLE_FILE</code>：通过 OLE 上传文件。</li><li><code>--check-file=XPC_FILE</code>：使用 xp_fileexist 检查文件存在性。</li><li><code>--ole-del=OLE_DEL_FILE</code>：通过 OLE 删除文件。</li><li><code>--ole-read=OLE_READ_FILE</code>：通过 OLE 读取文件。</li><li><code>--ole-move=OLE_MOVE_FILES</code>：通过 OLE 移动文件。</li><li><code>--ole-copy=OLE_COPY_FILES</code>：通过 OLE 复制文件。</li></ul></details><details open><summary> <b>操作系统访问选项</b></summary><ul><li><code>--os-cmd=OSCMD</code>：执行操作系统命令。</li><li><code>--os-shell</code>：交互式操作系统 shell。</li><li><code>--enable-clr</code>：启用 CLR。</li><li><code>--disable-clr</code>：禁用 CLR。</li><li><code>--enable-ole</code>：启用 OLE。</li><li><code>--check-clr=CHECK_CLR</code>：检查数据库中的用户定义过程。</li><li><code>--del-clr=DEL_PROCEDURE</code>：删除用户定义过程。</li><li><code>--install-clr</code>：安装 CLR。</li><li><code>--clr-shell</code>：CLR shell。</li><li><code>--sharpshell-upload1</code>：Sharpshell上传方式1。</li><li><code>--sharpshell-upload2</code>：Sharpshell上传方式2。</li><li><code>--os-pwn</code>：获取 OOB shell/Meterpreter/VNC。</li><li><code>--os-smbrelay</code>：一键获取 OOB shell/Meterpreter/VNC。</li><li><code>--os-bof</code>：存储过程缓冲区溢出利用。</li><li><code>--priv-esc</code>：数据库进程权限提升。</li><li><code>--msf-path=MSFPATH</code>：Metasploit 安装路径。</li><li><code>--tmp-path=TMPPATH</code>：服务器临时文件目录。</li></ul></details><details open><summary> <b>Windows 注册表访问选项</b></summary><ul><li><code>--reg-read</code>：读取注册表键值。</li><li><code>--reg-add</code>：写入注册表键值。</li><li><code>--reg-del</code>：删除注册表键值。</li><li><code>--reg-key=REGKEY</code>：注册表键路径。</li><li><code>--reg-value=REGVAL</code>：注册表值名称。</li><li><code>--reg-data=REGDATA</code>：注册表值数据。</li><li><code>--reg-type=REGTYPE</code>：注册表值类型。</li></ul></details><details open><summary> <b>常规选项</b></summary><ul><li><code>-s SESSIONFILE</code>：从 .sqlite 文件加载会话。</li><li><code>-t TRAFFICFILE</code>：记录所有 HTTP 流量到文本文件。</li><li><code>--abort-on-empty</code>：空结果时中止数据检索。</li><li><code>--answers=ANSWERS</code>：预设答案（例如：<code class="full">"quit=N,follow=N"</code>）。</li><li><code>--base64=BASE64_PARAM</code>：包含 Base64 编码数据的参数。</li><li><code>--base64-safe</code>：使用 URL 安全的 Base64 编码。</li><li><code>--batch</code>：非交互模式使用默认行为。</li><li><code>--binary-fields=FIELDS</code>：二进制结果字段（例如：<code>"digest"</code>）。</li><li><code>--check-internet</code>：评估目标前检查网络连接。</li><li><code>--cleanup</code>：清除 sqlmap 创建的 UDF 和表。</li><li><code>--crawl=CRAWLDEPTH</code>：从目标 URL 开始爬取网站。</li><li><code>--crawl-exclude=REGEX</code>：排除爬取的页面正则。</li><li><code>--csv-del=CSVDEL</code>：CSV 输出分隔符（默认值：<code>,</code>）。</li><li><code>--charset=CHARSET</code>：盲注字符集（例如：<code>"0123456789abcdef"</code>）。</li><li><code>--dump-file=DUMP_FILE</code>：转储数据存储路径。</li><li><code>--dump-format=DUMP_FORMAT</code>：转储格式（<code>CSV</code>、<code>HTML</code>、<code>SQLITE</code> 等）。</li><li><code>--encoding=ENCODING</code>：数据检索字符编码（例如：<code>GBK</code>）。</li><li><code>--eta</code>：显示预计完成时间。</li><li><code>--flush-session</code>：清除当前目标的会话文件。</li><li><code>--forms</code>：解析测试目标 URL 的表单。</li><li><code>--fresh-queries</code>：忽略会话文件中存储的查询结果。</li><li><code>--gpage=GOOGLEPAGE</code>：指定 Google 搜索结果页码。</li><li><code>--har=HARFILE</code>：记录 HTTP 流量到 HAR 文件。</li><li><code>--hex</code>：使用十六进制转换检索数据。</li><li><code>--output-dir=OUT_DIR</code>：自定义输出目录。</li><li><code>--parse-errors</code>：解析显示数据库错误信息。</li><li><code>--preprocess=PRE_SCRIPT</code>：请求预处理脚本。</li><li><code>--postprocess=POST_SCRIPT</code>：响应后处理脚本。</li><li><code>--repair</code>：修复含未知字符标记(?)的条目。</li><li><code>--save=SAVECONFIG</code>：保存配置到 INI 文件。</li><li><code>--scope=SCOPE</code>：目标过滤正则表达式。</li><li><code>--skip-heuristics</code>：跳过漏洞启发式检测。</li><li><code>--skip-waf</code>：跳过 WAF/IPS 检测。</li><li><code>--table-prefix=TBL_PREFIX</code>：临时表前缀（默认值：<code>sqlmap</code>）。</li><li><code>--test-filter=TEST_FILTER</code>：通过载荷/标题筛选测试。</li><li><code>--test-skip=TEST_SKIP</code>：通过载荷/标题跳过测试。</li><li><code>--time-limit=TIME_LIMIT</code>：运行时间限制（单位：秒）。</li><li><code>--web-root=WEBROOT</code>：Web服务器根目录（例如：<code>"/var/www"</code>）。</li></ul></details><details open><summary> <b>杂项选项</b></summary><ul><li><code>-z MNEMONICS</code>：使用速记符（例如：<code class="full">"flu,bat,ban,tec=EU"</code>）。</li><li><code>--alert=ALERT</code>：发现注入时执行系统命令。</li><li><code>--beep</code>：发现漏洞时发出提示音。</li><li><code>--dependencies</code>：检查缺失依赖。</li><li><code>--disable-coloring</code>：禁用控制台颜色输出。</li><li><code>--list-tampers</code>：显示可用篡改脚本列表。</li><li><code>--no-logging</code>：禁用日志记录。</li><li><code>--offline</code>：离线模式（仅使用会话数据）。</li><li><code>--purge</code>：清空 sqlmap 数据目录。</li><li><code>--results-file=RESULTS_FILE</code>：多目标模式结果文件路径。</li><li><code>--shell</code>：交互式 sqlmap shell。</li><li><code>--tmp-dir=TMPDIR</code>：临时文件存储目录。</li><li><code>--unstable</code>：调整选项适应不稳定连接。</li><li><code>--update</code>：更新 sqlmap。</li><li><code>--wizard</code>：新手向导模式。</li></ul></details>