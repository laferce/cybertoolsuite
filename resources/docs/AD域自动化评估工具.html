<h2>AD域自动化评估工具 帮助文档</h2><div>由 @NeffIsBack、@MJHallenbeck、@_zblurx 维护的开源项目。</div><div>文档和使用示例：<a target="_blank" href="https://www.netexec.wiki/" rel="noreferrer nofollow noopener">https://www.netexec.wiki/</a></div><details open><summary> <b>支持的协议</b></summary><ul><li><details open><summary> <code class="usage">nxc.exe ftp [选项]</code>：使用 FTP 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>--port PORT</code>：指定 FTP 服务端口（默认值：<code>21</code>）。</li></ul></details></li><li><details open><summary> FTP 访问</summary><ul><li><code>--ls</code>：列出 FTP 目录中的文件。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe ldap [选项]</code>：使用 LDAP 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>-H HASH</code>：NTLM 哈希值或包含哈希的文件。</li><li><code>--port {636,389}</code>：指定 LDAP 服务端口（默认值：<code>389</code>）。</li><li><code>--no-smb</code>：禁用 SMB 连接。</li><li><code>-d DOMAIN</code>：认证目标域。</li><li><code>--local-auth</code>：本地认证，不通过域。</li></ul></details></li><li><details open><summary> 远程域控制器哈希提取</summary><ul><li><code>--asreproast ASREPROAST</code>：提取 AS_REP 响应，用于 Hashcat 破解。</li><li><code>--kerberoasting KERBEROASTING</code>：提取 TGS 票据，用于 Hashcat 破解。</li></ul></details></li><li><details open><summary> 域环境信息收集</summary><ul><li><code>--trusted-for-delegation</code>：列出具有“信任委派”权限的账户。</li><li><code>--password-not-required</code>：列出密码策略为“非必需”的用户。</li><li><code>--admin-count</code>：列出 adminCount=1 的对象（特权账户）。</li><li><code>--users</code>：枚举启用状态的域用户。</li><li><code>--groups</code>：枚举域用户组。</li><li><code>--dc-list</code>：列出域控制器。</li><li><code>--get-sid</code>：获取域 SID。</li></ul></details></li><li><details open><summary> 组托管服务账户（GMSA）操作</summary><ul><li><code>--gmsa</code>：枚举 GMSA 密码。</li><li><code>--gmsa-convert-id GMSA_CONVERT_ID</code>：解析 GMSA 密钥名称（如未指定 ID，将全部解析）。</li><li><code>--gmsa-decrypt-lsa GMSA_DECRYPT_LSA</code>：解密 LSA 存储的 GMSA 加密值。</li></ul></details></li><li><details open><summary> 血影（BloodHound）拓扑分析</summary><ul><li><code>--bloodhound</code>：执行 BloodHound 数据收集。</li><li><code>-ns NAMESERVER</code>：自定义 DNS 服务器 IP。</li><li><code>-c COLLECTION</code>：指定收集数据类型（默认值：<code>Default</code>）。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe mssql [选项]</code>：使用 MSSQL 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>-H HASH</code>：NTLM 哈希值或包含哈希的文件。</li><li><code>--port PORT</code>：指定 SQL Server 服务端口（默认值：<code>1433</code>）。</li><li><code>-q QUERY, --query QUERY</code>：对 SQL Server 数据库执行指定查询。</li><li><code>--no-smb</code>：禁用 SMB 连接。</li><li><code>-d DOMAIN</code>：认证目标域。</li><li><code>--local-auth</code>：本地认证，不通过域。</li></ul></details></li><li><details open><summary> 远程命令执行</summary><ul><li><code>--force-ps32</code>：强制 PowerShell 命令在 32 位进程运行。</li><li><code>--no-output</code>：不获取命令输出结果。</li><li><code>-x COMMAND</code>：执行指定系统命令。</li><li><code>-X PS_COMMAND</code>：执行指定 PowerShell 命令。</li></ul></details></li><li><details open><summary> PowerShell 混淆</summary><ul><li><code>--obfs</code>：混淆 PowerShell 脚本。</li><li><code>--clear-obfscripts</code>：清除所有缓存的混淆脚本。</li></ul></details></li><li><details open><summary> 远程文件操作</summary><ul><li><code>--put-file FILE FILE</code>：上传本地文件至远程目标。</li><li><code>--get-file FILE FILE</code>：下载远程目标文件至本地。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe rdp [选项]</code>：使用 RDP 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>-H HASH</code>：NTLM 哈希值或包含哈希的文件。</li><li><code>--port PORT</code>：指定 RDP 服务端口。</li><li><code>--rdp-timeout RDP_TIMEOUT</code>：设置 RDP 协议 Socket 连接超时时间（默认值：<code>5s</code>）。</li><li><code>--nla-screenshot</code>：若目标未启用网络级认证（NLA），自动截取 RDP 登录界面。</li><li><code>-d DOMAIN</code>：认证目标域。</li><li><code>--local-auth</code>：本地认证，不通过域。</li></ul></details></li><li><details open><summary> 远程桌面截屏</summary><ul><li><code>--screenshot</code>：RDP 连接成功后自动截取远程桌面画面。</li><li><code>--screentime SCREENTIME</code>：指定桌面图像加载等待时间（默认值：<code>10s</code>）。</li><li><code>--res RES</code>：指定截图分辨率，格式为：宽x高（默认值：<code>1024x768</code>）。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe smb [选项]</code>：使用 SMB 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>-H HASH</code>：NTLM 哈希值或包含哈希的文件。</li><li><code>-d DOMAIN</code>：认证目标域。</li><li><code>--local-auth</code>：本地认证，不通过域。</li><li><code>--port {139,445}</code>：指定 SMB 服务端口（默认值：<code>445</code>）。</li><li><code>--share SHARE</code>：指定共享目录（默认值：<code>C$</code>）。</li><li><code>--smb-server-port SMB_SERVER_PORT</code>：指定 SMB 服务器端口。</li><li><code>--gen-relay-list OUTPUT_FILE</code>：输出所有无需 SMB 签名的主机到指定文件。</li><li><code>--smb-timeout SMB_TIMEOUT</code>：设置 SMB 连接超时时间（默认值：<code>2s</code>）。</li><li><code>--laps [LAPS]</code>：使用本地管理员密码解决方案（LAPS）进行身份验证。</li></ul></details></li><li><details open><summary> 凭据收集</summary><ul><li><code>--sam</code>：从目标系统提取本地账户的 SAM 数据库哈希。</li><li><code>--lsa</code>：从目标系统提取本地安全机构（LSA）存储的凭据。</li><li><code>--ntds [{vss,drsuapi}]</code>：从域控制器导出 NTDS.dit（默认值：<code>drsuapi</code>）。</li><li><code>--dpapi [...]</code>：导出 DPAPI 机密（支持附加参数 cookies 或 nosystem）。</li><li><code>--mkfile MKFILE</code>：指定包含主密钥的文件（格式：{GUID}:SHA1）。</li><li><code>--pvk PVK</code>：指定域备份密钥文件（PVK 格式）。</li><li><code>--enabled</code>：	仅导出已启用的账户。</li><li><code>--user USERNTDS</code>：导出指定用户的 NTDS 信息。</li></ul></details></li><li><details open><summary> 映射与枚举</summary><ul><li><code>--shares</code>：枚举共享目录及访问权限。</li><li><code>--no-write-check</code>：跳过共享目录的写入检查（避免因缺少删除权限而留下痕迹）。</li><li><code>--filter-shares FILTER_SHARES [FILTER_SHARES ...]</code>：按权限过滤共享（可选：<code>read</code>、<code>write</code>、<code class="full">read,write</code>）。</li><li><code>--sessions</code>：枚举活动会话。</li><li><code>--disks</code>：枚举磁盘信息。</li><li><code>--loggedon-users-filter LOGGEDON_USERS_FILTER</code>：按正则表达式过滤已登录用户。</li><li><code>--loggedon-users</code>：枚举已登录用户。</li><li><code>--users [USER]</code>：枚举域用户，可指定单个用户查询详细信息。</li><li><code>--groups [GROUP]</code>：枚举域组，可指定组名查询成员。</li><li><code>--computers [COMPUTER]</code>：枚举计算机账户。</li><li><code>--local-groups [GROUP]</code>：枚举本地组，可指定组名查询成员。</li><li><code>--pass-pol</code>：导出密码策略。</li><li><code>--rid-brute [MAX_RID]</code>：指定 RID 上限并通过 RID 暴力破解枚举用户（默认值：<code>4000</code>）。</li><li><code>--wmi QUERY</code>：执行指定的 WMI 查询。</li><li><code>--wmi-namespace NAMESPACE</code>：指定 WMI 命名空间（默认值：<code>root\cimv2</code>）。</li></ul></details></li><li><details open><summary> 共享爬取</summary><ul><li><code>--spider SHARE</code>：爬取指定共享目录。</li><li><code>--spider-folder FOLDER</code>：指定爬取起始目录（默认值：共享根目录）。</li><li><code>--content</code>：启用文件内容搜索。</li><li><code>--exclude-dirs DIR_LIST</code>：排除指定目录。</li><li><code>--pattern PATTERN [PATTERN ...]</code>：按关键词匹配文件夹/文件名及内容。</li><li><code>--regex REGEX [REGEX ...]</code>：按正则表达式匹配文件夹/文件名及内容。</li><li><code>--depth DEPTH</code>：设置爬取深度。</li><li><code>--only-files</code>：跳过目录，只爬取文件。</li></ul></details></li><li><details open><summary> 远程文件操作</summary><ul><li><code>--put-file FILE FILE</code>：上传本地文件到远程路径。</li><li><code>--get-file FILE FILE</code>：下载远程文件到本地。</li><li><code>--append-host</code>：在下载文件名中附加主机名。</li></ul></details></li><li><details open><summary> 远程命令执行</summary><ul><li><code>--exec-method {atexec,mmcexec,wmiexec,smbexec}</code>：指定命令执行方式（默认值：<code>wmiexec</code>；可选：<code>atexec</code>、<code>mmcexec</code>、<code>wmiexec</code>、<code>smbexec</code>）。</li><li><code>--dcom-timeout DCOM_TIMEOUT</code>：设置 DCOM 连接超时时间（默认值：<code>5s</code>）。</li><li><code>--get-output-tries GET_OUTPUT_TRIES</code>：设置获取命令输出的尝试次数（默认值：<code>5</code>）。</li><li><code>--codec CODEC</code>：设置输出编码（默认值：<code>utf-8</code>；需参考 <a href="https://docs.python.org/3/library/codecs.html#standard-encodings">Python 标准编码列表</a>）。</li><li><code>--force-ps32</code>：强制 PowerShell 命令在 32 位进程运行。</li><li><code>--no-output</code>：不获取命令输出结果。</li><li><code>-x COMMAND</code>：执行指定系统命令。</li><li><code>-X PS_COMMAND</code>：执行指定 PowerShell 命令。</li></ul></details></li><li><details open><summary> PowerShell 混淆</summary><ul><li><code>--obfs</code>：混淆 PowerShell 脚本。</li><li><code>--amsi-bypass FILE</code>：指定自定义 AMSI 绕过脚本文件。</li><li><code>--clear-obfscripts</code>：清除所有缓存的混淆脚本。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe ssh [选项]</code>：使用 SSH 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的 IP 地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>--key-file KEY_FILE</code>：使用指定私钥文件进行认证，将 password 参数视为该密钥的密码短语。</li><li><code>--port PORT</code>：指定 SSH 服务端口（默认值：<code>22</code>）。</li></ul></details></li><li><details open><summary> 远程命令执行</summary><ul><li><code>--no-output</code>：不获取命令输出结果。</li><li><code>-x COMMAND</code>：执行指定系统命令。</li><li><code>--remote-enum</code>：自动执行预定义的远程命令进行系统信息枚举。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe vnc [选项]</code>：使用 VNC 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>--port PORT</code>：指定 VNC 服务端口。</li><li><code>--vnc-sleep VNC_SLEEP</code>：设置 VNC 协议 Socket 连接超时时间。</li></ul></details></li><li><details open><summary> 远程桌面截屏</summary><ul><li><code>--screenshot</code>：VNC 连接成功后自动截取远程桌面画面。</li><li><code>--screentime SCREENTIME</code>：指定桌面图像加载等待时间。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe winrm [选项]</code>：使用 WINRM 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>-H HASH</code>：NTLM 哈希值或包含哈希的文件。</li><li><code>--port PORT</code>：指定 WinRM 服务端口。</li><li><code>--ssl</code>：启用 SSL 加密连接至 WinRM 服务。</li><li><code>--ignore-ssl-cert</code>：跳过服务器 SSL 证书有效性检查。</li><li><code>--laps [LAPS]</code>：使用本地管理员密码解决方案（LAPS）进行身份验证。</li><li><code>--http-timeout HTTP_TIMEOUT</code>：设置 WinRM 连接的超时时间。</li><li><code>--no-smb</code>：禁用 SMB 连接。</li><li><code>-d DOMAIN</code>：认证目标域。</li><li><code>--local-auth</code>：本地认证，不通过域。</li></ul></details></li><li><details open><summary> 凭据收集</summary><ul><li><code>--sam</code>：从目标系统提取本地账户的 SAM 数据库哈希。</li><li><code>--lsa</code>：从目标系统提取本地安全机构（LSA）存储的凭据。</li></ul></details></li><li><details open><summary> 远程命令执行</summary><ul><li><code>--codec CODEC</code>：设置输出编码（默认值：<code>utf-8</code>；需参考 <a href="https://docs.python.org/3/library/codecs.html#standard-encodings">Python 标准编码列表</a>）。</li><li><code>--no-output</code>：不获取命令输出结果。</li><li><code>-x COMMAND</code>：执行指定系统命令。</li><li><code>-X PS_COMMAND</code>：执行指定 PowerShell 命令。</li></ul></details></li></ul></details></li><li><details open><summary> <code class="usage">nxc.exe wmi [选项]</code>：使用 WMI 占领目标。</summary><ul><li><details open><summary> 位置参数</summary><ul><li><code>target</code>：支持 IP、IP 段、CIDR、主机名、FQDN、包含目标列表的文本文件、NMap XML 或 Nessus 文件。</li></ul></details></li><li><details open><summary> 选项</summary><ul><li><code>-id CRED_ID [CRED_ID ...]</code>：指定数据库凭证ID进行认证（多选）。</li><li><code>-u USERNAME [USERNAME ...]</code>：用户名或包含用户名的文件。</li><li><code>-p PASSWORD [PASSWORD ...]</code>：密码或包含密码的文件。</li><li><code>--ignore-pw-decoding</code>：忽略密码文件中的非 UTF-8 字符解码错误。</li><li><code>-k, --kerberos</code>：启用 Kerberos 认证。</li><li><code>--no-bruteforce</code>：禁用暴力破解模式（用户与密码按顺序配对：user1=>password1, user2=>password2）。</li><li><code>--continue-on-success</code>：认证成功后继续尝试其他凭证。</li><li><code>--use-kcache</code>：使用 Kerberos 缓存文件（KRB5CCNAME）进行认证。</li><li><code>--log LOG</code>：将结果输出到自定义日志文件。</li><li><code>--aesKey AESKEY [AESKEY ...]</code>：指定 Kerberos 认证的 AES 密钥（128 或 256位）。</li><li><code>--kdcHost KDCHOST</code>：指定域控制器 FQDN（若未指定，则使用目标参数中的域名部分）。</li><li><code>--gfail-limit LIMIT</code>：全局最大失败登录次数。</li><li><code>--ufail-limit LIMIT</code>：单个用户名最大失败登录次数。</li><li><code>--fail-limit LIMIT</code>：单个主机最大失败登录次数。</li><li><code>-M MODULE, --module MODULE</code>：指定使用的模块。</li><li><code>-o MODULE_OPTION [MODULE_OPTION ...]</code>：传递模块参数。</li><li><code>-L, --list-modules</code>：列出所有可用模块。</li><li><code>--options</code>：显示当前模块的配置选项。</li><li><code>--server {http,https}</code>：选择服务器协议（默认值：<code>https</code>）。</li><li><code>--server-host HOST</code>：绑定服务器的IP地址（默认值：<code>0.0.0.0</code>）。</li><li><code>--server-port PORT</code>：设置服务器监听端口。</li><li><code>--connectback-host CHOST</code>：设置远程系统回连的 IP（默认与 server-host 相同）。</li><li><code>-H HASH</code>：NTLM 哈希值或包含哈希的文件。</li><li><code>--port {135}</code>：指定 WMI 服务端口（默认值：<code>135</code>）。</li><li><code>--rpc-timeout RPC_TIMEOUT</code>：设置 WMI 连接的超时时间。</li><li><code>-d DOMAIN</code>：认证目标域。</li><li><code>--local-auth</code>：本地认证，不通过域。</li></ul></details></li><li><details open><summary> 映射与枚举</summary><ul><li><code>--wmi QUERY</code>：执行指定的 WMI 查询。</li><li><code>--wmi-namespace NAMESPACE</code>：指定 WMI 命名空间（默认值：<code>root\cimv2</code>）。</li></ul></details></li><li><details open><summary> 远程命令执行</summary><ul><li><code>--no-output</code>：不获取命令输出结果。</li><li><code>-x COMMAND</code>：执行指定系统命令。</li><li><code>--exec-method {wmiexec,wmiexec-event}</code>：指定命令执行方式（默认值：<code>wmiexec</code>；可选：<code>wmiexec</code>、<code>wmiexec-event</code>）。</li><li><code>--exec-timeout exec_timeout</code>：设置命令执行超时时间，建议最小5秒（默认值：<code>5</code>；单位：秒）。</li><li><code>--codec CODEC</code>：设置输出编码（默认值：<code>utf-8</code>；需参考 <a href="https://docs.python.org/3/library/codecs.html#standard-encodings">Python 标准编码列表</a>）。</li></ul></details></li></ul></details></li></ul></details><details open><summary> <b>选项</b></summary><ul><li><code>-h, --help</code>：显示帮助信息并退出。</li><li><code>-t THREADS</code>：设置并发线程的数量（默认值：100）。</li><li><code>--timeout TIMEOUT</code>：每个线程的最大超时时间（秒）。</li><li><code>--jitter INTERVAL</code>：在每次连接之间设置随机延迟。</li><li><code>--no-progress</code>：在扫描过程中不显示进度条。</li><li><code>--verbose</code>：启用详细输出。</li><li><code>--debug</code>：启用调试级别信息。</li><li><code>--version</code>：显示 nxc 的版本信息。</li></ul></details>