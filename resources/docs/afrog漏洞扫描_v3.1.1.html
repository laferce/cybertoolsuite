<h2>afrog漏洞扫描 帮助文档</h2><h3>用法</h3><code class="usage">afrog.exe [参数]</code><details open><summary> <b>目标</b></summary><ul><li><code>-t, -target string[]</code>：指定要扫描的目标 URL/主机（逗号分隔）。</li><li><code>-T, -target-file string</code>：指定包含目标 URL/主机的文件（每行一个）。</li><li><code>-cs, -cyberspace string</code>：进行 cyberspace 搜索引擎搜索，例如：<code class="full">-cs zoomeye</code>。</li><li><code>-q, -query string</code>：cyberspace 搜索框关键词，例如：<code class="full">-q app:'tomcat'</code>。</li><li><code>-qc, -query-count int</code>：cyberspace 搜索引擎返回的数据条数，默认值：<code>100</code>。</li><li><code>-resume string</code>：使用 <code>resume.cfg</code> 文件恢复扫描。</li><li><code>-oob string</code>：设置 Out-of-Band (OOB) 适配器，例如：<code class="full">-oob ceyeio</code>、<code class="full">-oob dnslogcn</code>、<code class="full">-oob alphalog</code>。</li></ul></details><details open><summary> <b>PoC</b></summary><ul><li><code>-P, -poc-file string</code>：指定要扫描的 PoC 文件或目录。</li><li><code>-ap, -append-poc string[]</code>：追加要扫描的 PoC 文件或目录（逗号分隔）。</li><li><code>-pd, -poc-detail string</code>：显示指定 PoC 的详细信息。</li><li><code>-pl, -poc-list</code>：列出所有可用的 PoC。</li><li><code>-ep, -exclude-pocs string[]</code>：排除不参与扫描的 PoC（逗号分隔）。</li><li><code>-epf, -exclude-pocs-file string</code>：指定包含要排除的 PoC 列表的文件。</li></ul></details><details open><summary> <b>输出</b></summary><ul><li><code>-o, -output string</code>：将结果写入 HTML 文件，包含所有漏洞信息。</li><li><code>-j, -json string</code>：将结果写入 JSON 文件，但不包含请求和响应内容。</li><li><code>-ja, -json-all string</code>：将结果写入 JSON 文件，包含所有漏洞信息。</li><li><code>-doh, -disable-output-html</code>：禁用自动生成 HTML 报告（优先级高于 <code>-o</code> 选项）。</li></ul></details><details open><summary> <b>过滤</b></summary><ul><li><code>-s, -search string</code>：通过关键词搜索 PoC，例如：<code class="full">-s tomcat,phpinfo</code>。</li><li><code>-S, -severity string</code>：根据严重性级别选择要运行的 PoC，支持：<code>info</code>, <code>low</code>, <code>medium</code>, <code>high</code>, <code>critical</code>, <code>unknown</code>。</li></ul></details><details open><summary> <b>速率限制</b></summary><ul><li><code>-rl, -rate-limit int</code>：每秒发送的最大请求数，默认值：<code>150</code>。</li><li><code>-c, -concurrency int</code>：并行执行的最大 PoC 数，默认值：<code>25</code>。</li><li><code>-smart</code>：根据扫描资产总数的变化智能调整并发数。</li><li><code>-orl, -oob-rate-limit int</code>：OOB PoC 每秒发送的最大请求数，默认值：<code>25</code>。</li><li><code>-oc, -oob-concurrency int</code>：OOB PoC 并行执行的最大 PoC 数，默认值：<code>25</code>。</li></ul></details><details open><summary> <b>优化</b></summary><ul><li><code>-retries int</code>：失败请求的重试次数，默认值：<code>1</code>。</li><li><code>-timeout int</code>：请求超时时间（秒），默认值：<code>10</code>。</li><li><code>-mt</code>：在扫描期间启用监控目标功能。</li><li><code>-mhe int</code>：主机在被跳过扫描前允许的最大错误数，默认值：<code>3</code>。</li><li><code>-mrbs int</code>：HTTP 响应体的最大大小，默认值：<code>2</code>。</li><li><code>-silent</code>：仅显示结果，不显示其他信息。</li><li><code>-pedm</code>：监控并记录每个 PoC 的执行时间，以识别执行时间最长的 PoC。</li><li><code>-vsb</code>：一旦检测到漏洞，立即停止扫描并报告漏洞。</li><li><code>-H, -header string[]</code>：在所有 HTTP 请求中包含自定义头部/cookie，格式为 <code>key:value</code>（逗号分隔），例如：<code class="full">-H 'X-Forwarded-For: 1.1.1.1'</code> 或 <code class="full">-H 'Cookie: JSESSION=xxx;'</code>。</li><li><code>-sort</code>：扫描排序，默认按安全级别排序，<code class="full">-sort a-z</code> 按字母顺序排序。</li></ul></details><details open><summary> <b>更新</b></summary><ul><li><code>-un, -update</code>：将 afrog 引擎更新到最新版本。</li><li><code>-duc, -disable-update-check</code>：禁用自动更新 afrog-pocs。</li></ul></details><details open><summary> <b>代理</b></summary><ul><li><code>-proxy string</code>：指定要使用的 HTTP/SOCKS5 代理列表（逗号分隔或文件输入）。</li></ul></details><details open><summary> <b>调试</b></summary><ul><li><code>-debug</code>：显示所有请求和响应。</li><li><code>-v, -version</code>：显示 afrog 版本。</li></ul></details><details open><summary> <b>服务器</b></summary><ul><li><code>-web</code>：启动 Web 服务器。</li></ul></details><details open><summary> <b>Webhook</b></summary><ul><li><code>-dingtalk</code>：启动 DingTalk Webhook。</li></ul></details><details open><summary> <b>配置</b></summary><ul><li><code>-config string</code>：指定 afrog 配置文件的路径。</li></ul></details>